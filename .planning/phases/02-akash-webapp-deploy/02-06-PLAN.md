---
phase: 02-akash-webapp-deploy
type: gap-closure
gap_closure: true
plan: 06
depends_on:
  - 02-03-PLAN.md
files_modified:
  - offchain/src/components/akash/requirements-form.tsx
autonomous: true
gap_reference:
  uat_file: .planning/phases/02-akash-webapp-deploy/02-UAT.md
  test: 1
  gap_truth: "Template gallery displays 6 templates and selecting a template advances to configuration step"
---

<objective>
Fix the Select component empty value bug in requirements-form.tsx that blocks the job submission wizard.

Purpose: Unblock the entire job submission flow by fixing the invalid SelectItem value="" that causes a runtime error.

Output: Fixed requirements-form.tsx with proper Select component handling for "Any Region" placeholder option.
</objective>

<execution_context>
@/home/julius/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/julius/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/02-akash-webapp-deploy/02-UAT.md
@.planning/phases/02-akash-webapp-deploy/02-03-PLAN.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix Select component empty value in Region dropdown</name>
  <files>offchain/src/components/akash/requirements-form.tsx</files>
  <action>
    Read the requirements-form.tsx file around line 314 where the error occurs.
    
    The issue is:
    ```tsx
    <SelectItem value="">Any Region</SelectItem>
    ```
    
    Radix UI Select doesn't allow empty string values. Fix by:
    1. Change value="" to value="any" (or another non-empty sentinel value)
    2. Update the onValueChange handler to convert "any" back to undefined when storing in state
    3. Update the value prop to show "any" when region is undefined
    
    Current code (lines ~306-321):
    ```tsx
    <Select
      value={value.region || ''}
      onValueChange={(v) => updateField('region', v || undefined)}
    >
      <SelectTrigger id="region">
        <SelectValue placeholder="Any" />
      </SelectTrigger>
      <SelectContent>
        <SelectItem value="">Any Region</SelectItem>
        {REGIONS.map((r) => (
          <SelectItem key={r.value} value={r.value}>
            {r.label}
          </SelectItem>
        ))}
      </SelectContent>
    </Select>
    ```
    
    Fixed code:
    ```tsx
    <Select
      value={value.region || 'any'}
      onValueChange={(v) => updateField('region', v === 'any' ? undefined : v)}
    >
      <SelectTrigger id="region">
        <SelectValue placeholder="Any Region" />
      </SelectTrigger>
      <SelectContent>
        <SelectItem value="any">Any Region</SelectItem>
        {REGIONS.map((r) => (
          <SelectItem key={r.value} value={r.value}>
            {r.label}
          </SelectItem>
        ))}
      </SelectContent>
    </Select>
    ```
    
    Make this change and save the file.
  </action>
  <verify>
    Run `npx eslint offchain/src/components/akash/requirements-form.tsx` - no errors.
    Verify the fix by checking:
    1. SelectItem value="any" (not empty string)
    2. onValueChange converts "any" to undefined
    3. value prop uses "any" as default when region is undefined
  </verify>
  <done>
    Select component fixed - uses "any" sentinel value instead of empty string.
  </done>
</task>

<task type="auto">
  <name>Task 2: Commit fix and update UAT</name>
  <files>.planning/phases/02-akash-webapp-deploy/02-UAT.md</files>
  <action>
    Commit the fix:
    ```bash
    git add offchain/src/components/akash/requirements-form.tsx
    git commit -m "fix(02-06): fix Select component empty value bug in requirements form"
    ```
    
    Update the UAT file:
    1. Update the gap to show it's being fixed
    2. Add root_cause and artifacts
    3. Remove paused_for_fix from frontmatter
    4. Update status to allow resuming testing
  </action>
  <verify>
    Verify commit exists with git log.
    Verify UAT file updated correctly.
  </verify>
  <done>
    Fix committed and UAT updated.
  </done>
</task>

</tasks>

<acceptance_criteria>
- [ ] Select component uses non-empty value ("any" instead of "")
- [ ] Job submission wizard no longer crashes on step 2
- [ ] "Any Region" option still works correctly (maps to undefined)
- [ ] Fix committed
- [ ] UAT file updated
- [ ] ESLint passes
</acceptance_criteria>
